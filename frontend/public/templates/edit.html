<!doctype html> 
<html> 
<head><meta charset="utf-8"><title>Editar Template</title> 
<style>body{font-family:Arial;max-width:700px;margin:20px auto;padding:0 
12px}input,textarea,select{width:100%;padding:8px;margin-top:6px;border:1px solid 
#ccc;border-radius:6px}</style> 
</head> 
<body> 
<h1>Editar Template</h1> 
<form id="form">Cargando...</form> 
<div id="msg" style="color:red;margin-top:10px"></div> 
<script> 
const USER_ID = 1; 
const id = new URLSearchParams(location.search).get("id"); 
(async ()=>{ 
const res = await fetch("/templates/"+id, { headers:{ "x-user-id":USER_ID }}); 
  const t = await res.json(); 
 
  document.getElementById("form").innerHTML = ` 
    <label>Nombre<input name="name" value="${t.name}" required></label> 
    <label>Descripci√≥n<textarea name="description">${t.description||""}</textarea></label> 
    <label>Prioridad 
      <select name="priority"> 
        <option ${t.priority==="MEDIUM"?"selected":""}>MEDIUM</option> 
        <option ${t.priority==="HIGH"?"selected":""}>HIGH</option> 
        <option ${t.priority==="LOW"?"selected":""}>LOW</option> 
      </select> 
    </label> 
    <label>Team ID<input name="teamId" value="${t.teamId||""}" type="number"></label> 
    <label>Tags<input name="tags" value="${(t.tags||[]).map(x=>x.id)}"></label> 
 
    <button>Guardar</button> 
    <button type="button" onclick="location.href='/templates'">Cancelar</button> 
  `; 
})(); 
 
document.getElementById("form").onsubmit = async(e)=>{ 
  e.preventDefault(); 
  const fd = new FormData(e.target); 
  const body = { 
    name: fd.get("name"), 
    description: fd.get("description"), 
    priority: fd.get("priority"), 
    teamId: fd.get("teamId") ? Number(fd.get("teamId")) : undefined, 
    tags: fd.get("tags") ? fd.get("tags").split(",").map(x=>Number(x.trim())) : [] 
  }; 
 
  const res = await fetch("/templates/"+id, { 
    method:"PUT", 
    headers:{ "Content-Type":"application/json", "x-user-id":USER_ID }, 
    body:JSON.stringify(body) 
  }); 
 
  if(res.ok){ 
    location.href="/templates"; 
  } else { 
    const err = await res.json(); 
    document.getElementById("msg").innerText = err.error || JSON.stringify(err); 
  } 
}; 
</script> 
</body> 
</html>
